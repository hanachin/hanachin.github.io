---
layout: post
title:  "ブロる"
date:   2014-04-07
categories: diary
---
精神衛生的によくない場合は知り合いでもどんどんブロるし、リムろう。

## 所感
「逆差別」「逆に酷い」を積極的に発言してる人はブロックしたい。
他いろいろ。

## 鬼から電話
すごく嫌なアプリだと思う。
何歳の子供に対して使うのを想定してるか問い合わせた。
9+のレーティングついてるのに、子供に使わせようとするの、いいの?
Twitterで検索すると嫌な画像とかひっかかるので見ない方がいいと思う。

## カジュアルにRubyのソースを読む
[Array#sample](https://github.com/ruby/ruby/blob/v2_1_1/array.c#L4499,L4625)のソースコード読んでた。

使われてる細かいのはいっぱい勉強になったけど

- randgenにいれるとRAND_UPTOマクロでそれ使われる
- 引数の取り方
- 引数ないときと、あるときの動作の違い
- ガード条件
- 3個までは特別扱い、直接`rb_ary_new_from_args`する
  - `++`してるのは数字がかぶらないように
- 10個まではランダムに10個選んで、コピる
- 10個を超えると配列コピってshuffle的な処理をしてから配列リサイズして先頭10個取る
- `RARRAY_AREF`で要素へのリファレンスとれる
- `RARRAY_PTR_USE`使うと、`VALUE`埋め込み配列と、`VALUE`の外のヒープ領域に確保されてる大きな配列との違いを気にせずポインタにアクセス出来る

そのあとのりで`Array#shuffle`も読んだ。`!`ついてるのは基本`dup`してからの操作っぽい

[今日はここも読んでた](https://github.com/ruby/ruby/blob/v2_0_0_451/ext/nkf/nkf.c#L184,L207)。
すごくデカイ文字列のエンコーディングを判定するの、どうやるのが一番かしこいんだろう。
なんかすごくデカイ文字列を渡される可能性があるときは、先頭行だけ見ればOKにするのが賢くて、「先頭行だけ見るよ」というのをドキュメントに書いておくのが賢い気がする。

## 久々にアドベンチャータイムを見た
面白い。いやし。LINEのスタンプ買っちゃった。


## 昨日

- 今日は非常にくさくて、外した後、人間の足も臭くなるスリッパを、洗って干した
- インターネットごしに接触してた人とあって顔と名前いっちさせた。友達の友達が友達。ゴーヤージャム(自分では食べたことない)をおみやげにあげた。実は友達の友達の友達の彼氏にはあったことあるけど友達の友達の友達にはブロックされている。
- 美味しいものたべたし、家事もしたし、okinawarbの記事で腐らせてたやつもやった。週末は雑なプルリク3つおくって雑なソフトウェア書いたし運動もしたし、今週は大満足な週だったな...
- 札をいれてボタン連打して無限モンスターカオスできる自販機教えてもらった
- あと歯も一本治った。はー、いい週末だった。

## 沖縄Ruby会議
1ヶ月おくれてすまん感。
